### 某网站发现 NDay 但无 POC 手动复现

目标是一个登录的页面， 还有配套的验证码，手工尝试几次后放弃

![](https://pic1.imgdb.cn/item/68ae0e0e58cb8da5c853269b.png)

于是直接去搜索公司+系统名称

![](https://pic1.imgdb.cn/item/68ae0ed058cb8da5c85326b3.png)

结果在 CNVD 发现曾经的任意文件 上传漏洞

![](https://pic1.imgdb.cn/item/68ae0f0258cb8da5c85326bc.png)

漏洞详情中存在漏洞具体的路径，于是直接访问查看

![](https://pic1.imgdb.cn/item/68ae0f3658cb8da5c85326c6.png)

上传按钮不起作用，直接构造数据包上传无果

返回页面依然是这个前段页面，所以需要找到真正的上传路径

![](https://pic1.imgdb.cn/item/68ae0f7458cb8da5c85326cb.png)

既然 CNVD 收录了，那肯定不止有一个改系统，所以找一个相同的系统存 在该漏洞的，然后替换数据包肯定行

直接去 FOFA 搜索公司，发现的确存在几套系统

大喜！遂复制路径，继续 开测

![](https://pic1.imgdb.cn/item/68ae105158cb8da5c85326d9.png)

可以上传，返回路径

![](https://pic1.imgdb.cn/item/68ae108c58cb8da5c85326da.png)

但是有黑名单

![image-20250827035316168](C:\Users\ydd33\AppData\Roaming\Typora\typora-user-images\image-20250827035316168.png)

本以为到此结束，想到了 `fileUpload_summernote.asp` 的空白页面

![](https://pic1.imgdb.cn/item/68ae110158cb8da5c85326e6.png)

有没有可能它就是那个真正的上传路径，构造数据包试试

![](https://pic1.imgdb.cn/item/68ae111558cb8da5c85326e7.png)

因为上面上传正常图片给了一个路径

![](https://pic1.imgdb.cn/item/68ae112958cb8da5c85326e8.png)

不死心的再来看看嘿～您猜怎么着～ 它还真在啊！

![](https://pic1.imgdb.cn/item/68ae113a58cb8da5c85326ee.png)

![](https://pic1.imgdb.cn/item/68ae114658cb8da5c85326f2.png)

在拿到权限后怀着好奇心又去看了看源码，首先是上传的黑名单很明显 是一个一个后缀去对比的，没啥好的办法

![](https://pic1.imgdb.cn/item/68ae116e58cb8da5c85326f3.png)

然后又去看了看白名单

这里首先获取文件名 --> 文件名转成小写

然后通过获取到的文件名去和白名单做对比，如果没有白名单内容则 `FilesType != 1` 然后提示只支持白名单文件

![](https://pic1.imgdb.cn/item/68ae11af58cb8da5c85326f8.png)

那么问题来了这里他获取的是整个的文件名称，以及做对比的也是整个 文件名称

![](https://pic1.imgdb.cn/item/68ae11c658cb8da5c85326fe.png)

所以说并不是获取的后缀去做对比那么是不是就可以这样写然后绕过

![](https://pic1.imgdb.cn/item/68ae11e058cb8da5c85326ff.png)

![](https://pic1.imgdb.cn/item/68ae11eb58cb8da5c8532701.png)

