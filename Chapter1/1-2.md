### 某网站 JSP 上传至其他目录绕过

前期回顾参考 11.2 节

有代码了，直接开始审计，通过关键字搜索 filepath,upload 等，发现到一个 `UploadFile` 方法存在任意文件上传

代码中没有任何对文件上传格式和内容的限制，直接上传 JSP

![](https://pic1.imgdb.cn/item/68b00baa58cb8da5c85b44dc.png)

高高兴兴的构造接口上传 JSP，也成功上传了，路径也返回，访问 JSP 文件路径时竟然提示没有权限跳转登录页面了

哈？？？

测试上传 txt，html 格式都能正常访问，唯独 JSP 文件有问题，猜测对 `uploads/` 目录中的 JSP 文件进行了限制

接着研究代码，`filePath` 可控，我们将上传的文件跨目录上传，将 JSP 上传到其他目录试试

![](https://pic1.imgdb.cn/item/68b00cbe58cb8da5c85b5717.png)

所以我找一个 help 目录， filePath 上传文件路径可控，使用 `../` 跨目录上传到 help 目录下，成功上传返回路径

![](https://pic1.imgdb.cn/item/68b00cd958cb8da5c85b5884.png)

![](https://pic1.imgdb.cn/item/68b00ce458cb8da5c85b5926.png)